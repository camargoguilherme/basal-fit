# Cursor Rules - Basal Fit Flutter

## ğŸ¯ Contexto do Projeto

Este Ã© um projeto **Flutter** de calculadora de Taxa MetabÃ³lica Basal (TMB) desenvolvido com **Clean Architecture** e **Firebase**. Foi criado utilizando IA (Claude Sonnet) + Cursor como exemplo de desenvolvimento assistido por IA.

## ğŸ—ï¸ Arquitetura e PadrÃµes

### **Clean Architecture Implementada:**

- **Entities**: `lib/models/` - Modelos de dados (UserProfile, Exercise, etc.)
- **Use Cases**: `lib/use_cases/` - Regras de negÃ³cio
- **Repositories**: `lib/repositories/` - AbstraÃ§Ã£o de dados
- **Services**: `lib/services/` - ImplementaÃ§Ã£o externa (Firebase)
- **Providers**: `lib/providers/` - State management (ChangeNotifier)
- **UI**: `lib/modules/` - Interface dividida por mÃ³dulos

### **PadrÃµes ObrigatÃ³rios:**

- **MVVM Pattern** para UI components
- **Repository Pattern** para acesso a dados
- **Result Pattern** (`lib/core/utils/result.dart`) para tratamento de erros
- **Dependency Injection** com Modular
- **Single Responsibility Principle**

## ğŸ“ Estrutura do Projeto

```
lib/
â”œâ”€â”€ core/                   # NÃºcleo da aplicaÃ§Ã£o
â”‚   â”œâ”€â”€ constants/         # Constantes globais
â”‚   â”œâ”€â”€ di/               # Dependency Injection
â”‚   â”œâ”€â”€ exceptions/       # ExceÃ§Ãµes customizadas
â”‚   â”œâ”€â”€ interfaces/       # Contratos/Interfaces
â”‚   â”œâ”€â”€ theme/           # Design System (AppTheme)
â”‚   â”œâ”€â”€ utils/           # UtilitÃ¡rios (Result pattern)
â”‚   â””â”€â”€ widgets/         # Componentes reutilizÃ¡veis
â”œâ”€â”€ models/              # Entidades/Modelos
â”œâ”€â”€ modules/             # Features por mÃ³dulo
â”‚   â”œâ”€â”€ auth/           # AutenticaÃ§Ã£o
â”‚   â””â”€â”€ home/           # Funcionalidades principais
â”œâ”€â”€ providers/          # State management
â”œâ”€â”€ repositories/       # Camada de dados
â”œâ”€â”€ services/          # ServiÃ§os externos
â”œâ”€â”€ use_cases/         # Regras de negÃ³cio
â””â”€â”€ main.dart
```

## ğŸ¨ Design System

### **Tema e Cores:**

- Use **AppTheme** de `lib/core/theme/app_theme.dart`
- Cores principais: `primaryColor`, `secondaryColor`, `backgroundColor`
- Gradientes: `primaryLinearGradient`, `cardGradient`
- EspaÃ§amentos: `spacingXS`, `spacingS`, `spacingM`, `spacingL`, `spacingXL`

### **Componentes ReutilizÃ¡veis:**

```dart
// Use componentes de lib/core/widgets/ui_components.dart
GradientCard()
MenuCard()
StatCard()
PrimaryButton()
SecondaryButton()
CustomTextField()
UserAvatar()
LoadingOverlay()
SectionHeader()
```

## ğŸ”¥ Firebase

### **ConfiguraÃ§Ã£o:**

- **Firestore**: Banco principal com regras de seguranÃ§a em `firebase/firestore.rules`
- **Auth**: Email/senha, Google, Facebook
- **Storage**: NÃƒO usar - imagens em base64 no Firestore
- **Rules**: Sempre validar permissÃµes e tipos de dados

### **Modelos Firebase:**

```dart
// Sempre implementar toMap() e fromMap()
class UserProfile {
  Map<String, dynamic> toMap() { ... }
  static UserProfile fromMap(Map<String, dynamic> map) { ... }
}
```

## ğŸ“ ConvenÃ§Ãµes de CÃ³digo

### **Nomenclatura:**

- **Classes**: PascalCase (`UserProfile`, `TmbCalculatorScreen`)
- **VariÃ¡veis/MÃ©todos**: camelCase (`calculateTmb`, `userProfile`)
- **Arquivos**: snake_case (`user_profile.dart`, `tmb_calculator_screen.dart`)
- **Constantes**: SCREAMING_SNAKE_CASE (`API_TIMEOUT`)

### **Estrutura de Widgets:**

```dart
class ExampleScreen extends StatefulWidget {
  const ExampleScreen({super.key});

  @override
  State<ExampleScreen> createState() => _ExampleScreenState();
}

class _ExampleScreenState extends State<ExampleScreen> {
  // Estado local

  @override
  void initState() {
    super.initState();
    // InicializaÃ§Ã£o
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      // UI
    );
  }

  // MÃ©todos privados por Ãºltimo
  void _privateMethod() { ... }
}
```

### **Tratamento de Erros:**

```dart
// Sempre usar Result pattern
Future<Result<UserProfile>> getUserProfile() async {
  try {
    final profile = await _firebaseService.getUserProfile();
    return Result.success(profile);
  } catch (e) {
    return Result.failure(DatabaseException('Erro ao buscar perfil: $e'));
  }
}

// Na UI
final result = await _getUserProfile();
result.when(
  success: (profile) => _updateUI(profile),
  failure: (error) => _showError(error.message),
);
```

## ğŸš€ Guidelines de Desenvolvimento

### **State Management:**

- Use **ChangeNotifier** para providers
- Use **StreamBuilder** para dados em tempo real do Firebase
- Use **StatefulWidget** apenas quando necessÃ¡rio

### **Performance:**

- Use `const` constructors sempre que possÃ­vel
- Implemente `ListView.builder` para listas grandes
- Use `FutureBuilder`/`StreamBuilder` adequadamente

### **ValidaÃ§Ã£o:**

```dart
// Use validators consistentes
String? validateEmail(String? value) {
  if (value == null || value.isEmpty) return 'Email Ã© obrigatÃ³rio';
  if (!RegExp(r'^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$').hasMatch(value)) {
    return 'Email invÃ¡lido';
  }
  return null;
}
```

### **Imports:**

```dart
// Ordem dos imports:
import 'package:flutter/material.dart';           // Flutter
import 'package:firebase_auth/firebase_auth.dart'; // Packages
import '../models/user_profile.dart';              // Relativos
```

## ğŸ“š DocumentaÃ§Ã£o

### **ComentÃ¡rios:**

- Documente **mÃ©todos pÃºblicos** e **classes importantes**
- Use **portuguÃªs** para comentÃ¡rios e documentaÃ§Ã£o
- Siga o padrÃ£o existente em `docs/`

### **README e Docs:**

- Mantenha `docs/` atualizado com mudanÃ§as
- Use **markdown** com emojis e formataÃ§Ã£o consistente
- Documente **breaking changes** e **novas features**

## ğŸ§ª Testes

### **Estrutura de Testes:**

```dart
void main() {
  group('UserProfile', () {
    test('deve calcular TMB corretamente', () {
      // Arrange
      final profile = UserProfile(/* ... */);

      // Act
      final tmb = profile.calculateTmb();

      // Assert
      expect(tmb, equals(expectedValue));
    });
  });
}
```

## ğŸ”§ Firebase Rules

### **Sempre validar:**

- AutenticaÃ§Ã£o: `request.auth != null`
- Propriedade: `request.auth.uid == resource.data.id`
- Tipos de dados e campos obrigatÃ³rios
- Tamanhos e formatos (email, nome, etc.)

## ğŸ­ UI/UX Guidelines

### **Responsividade:**

- Use `MediaQuery.of(context).size` para adaptaÃ§Ã£o
- Implemente breakpoints para tablet/desktop
- Use `Flexible` e `Expanded` adequadamente

### **AnimaÃ§Ãµes:**

```dart
// Use AnimationController com dispose
class _ScreenState extends State<Screen> with TickerProviderStateMixin {
  late AnimationController _controller;

  @override
  void dispose() {
    _controller.dispose();
    super.dispose();
  }
}
```

## ğŸš« NÃ£o FaÃ§a

- **NÃƒO** use Firebase Storage (apenas base64 no Firestore)
- **NÃƒO** faÃ§a commits sem documentaÃ§Ã£o
- **NÃƒO** ignore tratamento de erros
- **NÃƒO** use hardcoded strings (use constantes)
- **NÃƒO** misture lÃ³gica de negÃ³cio na UI

## âœ… Sempre FaÃ§a

- **USE** o Result pattern para tratamento de erros
- **IMPLEMENTE** loading states e feedback visual
- **VALIDE** dados de entrada
- **TESTE** em diferentes dispositivos
- **DOCUMENTE** mudanÃ§as importantes
- **SIGA** a Clean Architecture estabelecida

## ğŸ¤– IA Development Notes

Este projeto foi criado com **Claude Sonnet + Cursor** como demonstraÃ§Ã£o de desenvolvimento assistido por IA. Mantenha:

- **ConsistÃªncia** arquitetural
- **Qualidade** de cÃ³digo
- **DocumentaÃ§Ã£o** completa
- **PadrÃµes** estabelecidos

---

**Objetivo:** Manter o projeto como referÃªncia de qualidade para desenvolvimento Flutter com IA.
